!function(){var a=angular.module("angularBarchart",[]);a.directive("barChart",["$timeout",function(a){return{restrict:"E",replace:!0,scope:{data:"=data",barModel:"="},template:'<div class="bc-container"><div ng-repeat="item in data track by $index" ng-style="getBarBackgorundStyle()" ng-click="barItemClick(item)" class="bc-bar-backround"><span ng-style="getBarStyle(item)" class="bc-bar"></span><span ng-style="getBarTooltipStyle()" class="bc-bar-tooltip"><p><b>{{ item.value }}</b><br ng-if="item.data.description"/><span>{{ item.data.description }}</span></p></span></div><div ng-show="!data || data.length==0" class="bc-bar-nodata">Нет данных</div></div>',link:function(b,c){b.getMaxBarHeight=function(a){for(var b=0,c=[],d=0;d<a.length;d++)c.push(a[d].value);return b=Math.max.apply(Math,c)},b.drawBars=function(){for(var c=0;c<b.data.length;c++)b.data[c].barHeight=0;a(function(){for(var a=0;a<b.data.length;a++)b.data[a].barHeight=100*b.data[a].value/b.maxBarHeight})},b.init=function(){b.barContainerHeight=c[0].offsetHeight,b.barWidth=100/b.data.length,b.maxBarHeight=b.getMaxBarHeight(b.data),b.drawBars()},b.$watchCollection("data",function(){b.data&&0!==b.data.length&&b.init()}),b.barItemClick=function(a){if(b.barModel){var c=angular.copy(a);delete c.barHeight,b.barModel=c}},b.getBarBackgorundStyle=function(){return{width:b.barWidth+"%"}},b.getBarStyle=function(a){return{height:a.barHeight+"%"}},b.getBarTooltipStyle=function(a){return{bottom:b.barContainerHeight+5+"px"}}}}}])}();